SELECT a.sesann,
    a.scrnum,
    a.code,
    a.scrint,
    a.scrdat,
    a.scrpou,
    a.scrcon,
    a.scrvot,
    a.scrsuf,
    a.scrvotsea,
    a.scrsufsea,
    a.scrpousea,
    a.scrconsea,
    a.scrmaj,
    a.scrmajsea,
    a.soslib,
    a.scrbaspag,
    a.scrdateff,
    a.lecidt,
    a.date_s,
    a.code_bis,
    a.statut,
    a.lecassidt,
    a.lecidt_bis,
    a.codass,
    a.ordreass,
    a.sesann_bis,
    a.ptlnum,
    a.ptlurl,
    a.ptlnumcpl,
    a.ptlnot,
    a.ptlurl2,
    a.ptlnot2,
    a.ptlurl3,
    a.ptlnot3,
    a.ptlnumcpl2,
    a.ptlnumcpl3,
    a.lecassame,
    a.lecassameses,
    a.orgcod,
    a.loiintmod,
    a.reucom,
    a.debatsurl,
    a.depot_only,
    a.lecassamedat,
    a.lecassamecomdat,
    a.orippr,
    a.libppr,
    a.sesppr,
    a.ptlurlcom,
    a.aliasppr,
    a.lecassamecom,
    a.lecassamesescom,
    a.ptlnumcom,
    a.lecassameado,
    a.lecassameadodat,
    a.lecassameadoses,
    a.lecassamecomado,
    a.lecassamecomadodat,
    a.lecassamecomadoses,
    a.lecidt_ter,
    a.loicod,
    a.typleccod,
    a.leccom,
    a.loicod_bis,
    a.typloicod,
    a.etaloicod,
    a.deccoccod,
    a.numero,
    a.signet,
    a.loient,
    a.motclef,
    a.loitit,
    a.loiint,
    a.urgence,
    a.url_jo,
    a.loinumjo,
    a.loidatjo,
    a.date_loi,
    a.loititjo,
    a.url_jo2,
    a.loinumjo2,
    a.loidatjo2,
    a.deccocurl,
    a.num_decision,
    a.date_decision,
    a.loicodmai,
    a.loinoudelibcod,
    a.motionloiorigcod,
    a.objet,
    a.url_ordonnance,
    a.saisine_date,
    a.saisine_par,
    a.loidatjo3,
    a.loinumjo3,
    a.url_jo3,
    a.url_an,
    a.url_presart,
    a.signetalt,
    a.orgcod_bis,
    a.doscocurl,
    a.loiintori,
    a.proaccdat,
    a.proaccoppdat,
    a.retproaccdat,
    a.en_clair_url,
    a.en_clair_image,
    a.en_clair_chapo,
    array_agg(c.thecle) AS id_theme,
    array_agg(c.thelib) AS theme
   FROM senate_join a
     JOIN loithe b ON a.loicod = b.loicod
     JOIN the c ON b.thecle = c.thecle
  GROUP BY a.sesann, a.scrnum, a.code, a.scrint, a.scrdat, a.scrpou, a.scrcon, a.scrvot, a.scrsuf, a.scrvotsea, a.scrsufsea, a.scrpousea, a.scrconsea, a.scrmaj, a.scrmajsea, a.soslib, a.scrbaspag, a.scrdateff, a.lecidt, a.date_s, a.code_bis, a.statut, a.lecassidt, a.lecidt_bis, a.codass, a.ordreass, a.sesann_bis, a.ptlnum, a.ptlurl, a.ptlnumcpl, a.ptlnot, a.ptlurl2, a.ptlnot2, a.ptlurl3, a.ptlnot3, a.ptlnumcpl2, a.ptlnumcpl3, a.lecassame, a.lecassameses, a.orgcod, a.loiintmod, a.reucom, a.debatsurl, a.depot_only, a.lecassamedat, a.lecassamecomdat, a.orippr, a.libppr, a.sesppr, a.ptlurlcom, a.aliasppr, a.lecassamecom, a.lecassamesescom, a.ptlnumcom, a.lecassameado, a.lecassameadodat, a.lecassameadoses, a.lecassamecomado, a.lecassamecomadodat, a.lecassamecomadoses, a.lecidt_ter, a.loicod, a.typleccod, a.leccom, a.loicod_bis, a.typloicod, a.etaloicod, a.deccoccod, a.numero, a.signet, a.loient, a.motclef, a.loitit, a.loiint, a.urgence, a.url_jo, a.loinumjo, a.loidatjo, a.date_loi, a.loititjo, a.url_jo2, a.loinumjo2, a.loidatjo2, a.deccocurl, a.num_decision, a.date_decision, a.loicodmai, a.loinoudelibcod, a.motionloiorigcod, a.objet, a.url_ordonnance, a.saisine_date, a.saisine_par, a.loidatjo3, a.loinumjo3, a.url_jo3, a.url_an, a.url_presart, a.signetalt, a.orgcod_bis, a.doscocurl, a.loiintori, a.proaccdat, a.proaccoppdat, a.retproaccdat, a.en_clair_url, a.en_clair_image, a.en_clair_chapo;
